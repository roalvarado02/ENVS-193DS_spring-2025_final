---
title: "Final"
author: "Rachel Alvarado"
date: "06/11/25"
subtitle: "https://github.com/roalvarado02/ENVS-193DS_spring-2025_final.git" 
format:
  html:
    toc: true # use this to display a table of contents
execute:
  message: false # use this to make sure messages don't show up
  warning: false # use this to make sure messages don't show up
---



```{r}

library(readxl) #allows reading excel files
library(tidyverse) #load package for data manipulation and vizualization 
library(janitor) #load package for cleaning column names
library(dplyr) #package for data manipulation
library(gt) #package for themes
library(effectsize) #package to compute effect sizes
library(ggplot2) #package to create data visualization 
library(lubridate) #package to manipulate dates

sst <- read.csv("/home/jovyan/ES-193DS//Final/ENVS-193DS_spring-2025_final/data/seasurfacetemp.csv") #read in data 

```


# Problem 1: Research Writing

## a. Transparent statistical methods

In part 1, they used a Pearson correlation test to compare two continuous variables. A value of 0.03 is lower than the 0.05 significance threshold meaning there is a significant linear relationship between the variables, so they rejected the null hypothesis. 

In part 2, they used a one-way ANOVA test to compare a continuous variable to five categorical groups. The test was able to check if at least one group mean was significantly different from the others, and the p=0.02 indicated there was a difference so the null hypothesis was rejected.

## b. More information needed

Part 2 could include effect size such as Cohen's f to show how large the difference is. They could also use a Post-hoc pairwise comparison to determine which categorical groups are significantly different from each other.

## c. Suggestions for rewriting

Part 1: We found a significant positive relationship between distance from headwaters and annual total nitrogen load, suggesting that nitrogen accumulates downstream (Pearson correlation test, r = correlation coefficient, p = 0.03, α = 0.05). 

Part 2: Average nitrogen load differed significantly across source types, with higher loads from fertilizer and wastewater treatment sources compared to grasslands and urban land.
(One-way ANOVA, F = test statistic, df = degrees of freedom, p = 0.02, α = 0.05; post-hoc pairwise differences; effect size). 

# Problem 2: Data Visualization 

## a.

```{r}

sst_clean <- sst |>
  clean_names() |>
  mutate(
    date = ymd(date),                   
    year = year(date),
    month = month(date, label = TRUE, abbr = TRUE)) |>
  group_by(year, month) |>
  summarise(mean_monthly_sst = mean(temp, na.rm = TRUE), .groups = "drop")

slice_sample(sst_clean, n = 5)

str(sst_clean)


```



## b. 

```{r}

# Filter for correct years
sst_filtered <- sst_clean |> filter(year %in% 2018:2023)

ggplot(sst_filtered, aes(x = month, y = mean_monthly_sst, group = year)) +
  geom_line(aes(color = factor(year)), size = 0.5) +  # Thinner lines
  geom_point(aes(color = factor(year)), size = 2) +
  scale_color_manual(
    values = colorRampPalette(c("skyblue", "darkblue"))(6),
    name = "Year"
  ) +
  labs(
    x = "Month",
    y = "Mean monthly sea surface temperature (°C)"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    panel.grid = element_blank(),                     # Remove grid lines
    legend.position = c(0.05, 0.95),                  # Top left corner
    legend.justification = c("left", "top"),          # Align top-left
    panel.border = element_rect(colour = "black", fill = NA, size = 1),
    legend.title = element_text(size = 11),
    legend.text = element_text(size = 10)
  )


```


